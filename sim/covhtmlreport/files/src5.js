var g_data = {"name":"../rtl/register.v","src":"module register \n#(\n	parameter TCR 	= 12'h00,\n	parameter TDR0	= 12'h04,\n	parameter TDR1	= 12'h08,\n	parameter TCMP0	= 12'h0c,\n	parameter TCMP1 = 12'h10,\n	parameter TIER	= 12'h14,\n	parameter TISR 	= 12'h18,\n	parameter THCSR = 12'h1c\n)\n(\n	input 		wr_en,\n	input 		rd_en,\n	input [3:0]     tim_pstrb,\n	input [31:0]    tim_pwdata,\n	input [11:0]    tim_paddr,\n	input 		sys_clk,\n	input 		sys_rst_n,\n	input 		halt_ack,\n	input 		cnt_en,\n	input		pready,\n\n	output reg div_en,\n	output reg [3:0] div_val,\n	output reg halt_req,\n	output reg timer_en,\n	output reg int_en,\n	output reg int_st,\n	output reg [31:0] rdata,\n	output pslverr\n\n);	\n\n	//TCR\n	wire tcr_wr_sel;\n      	wire tcr_wr_sel_pre;\n\n	assign tcr_wr_sel = wr_en & (tim_paddr == TCR) ;\n	assign tcr_wr_sel_pre = (tim_pwdata[11:8] <= 8) & tcr_wr_sel & tim_pstrb[1];	\n	\n	wire [3:0] div_val_pre;	\n	wire div_en_pre, timer_en_pre;\n	assign div_val_pre = (tcr_wr_sel_pre && ~pslverr) ? tim_pwdata[11:8] : div_val;\n	assign div_en_pre  = (tcr_wr_sel && tim_pstrb[0] && ~pslverr) ? tim_pwdata[1] : div_en;\n	assign timer_en_pre = (tcr_wr_sel && tim_pstrb[0] && ~pslverr) ? tim_pwdata[0] : timer_en;\n\n	always @(posedge sys_clk or negedge sys_rst_n) begin\n		if(!sys_rst_n) begin\n			timer_en <= 1'b0;\n			div_val  <= 4'b0001;\n			div_en 	 <= 1'b0;\n		end else begin\n			timer_en <= timer_en_pre;\n			div_val <= div_val_pre;\n			div_en  <= div_en_pre;\n		end\n	end\n	wire [31:0] tcr;\n	assign tcr = {20'h0, div_val, 6'h0, div_en, timer_en};\n		\n\n	//TDR0; TDR1\n	\n	wire tdr0_wr_sel;\n	wire tdr1_wr_sel;\n	reg [31:0] tdr0;\n	reg [31:0] tdr1;\n	assign tdr0_wr_sel = wr_en & (tim_paddr == TDR0);\n	assign tdr1_wr_sel = wr_en & (tim_paddr == TDR1);\n\n	reg timer_en_d;\n	wire timer_en_negedge;\n	always @(posedge sys_clk or negedge sys_rst_n) begin \n		if(!sys_rst_n) begin\n			timer_en_d <= 1'b0;\n		end else begin\n			timer_en_d <= timer_en;\n		end \n	end\n\n	assign timer_en_negedge = (timer_en_d == 1) && (timer_en == 0);\n\n\n	always @(posedge sys_clk or negedge sys_rst_n) begin\n		if(!sys_rst_n) begin\n		       tdr0 <= 32'h0;\n		       tdr1 <= 32'h0;\n	       	end else begin \n				if(tdr0_wr_sel) begin\n					if(tim_pstrb[0]) begin\n						tdr0[7:0] <= tim_pwdata[7:0];\n					end else begin\n						tdr0[7:0] <= tdr0[7:0];\n					end\n					if(tim_pstrb[1]) begin\n						tdr0[15:8] <= tim_pwdata[15:8];\n					end else begin\n						tdr0[15:8] <= tdr0[15:8];\n					end\n					if(tim_pstrb[2]) begin\n						tdr0[23:16] <= tim_pwdata[23:16];\n					end else begin\n						tdr0[23:16] <= tdr0[23:16];\n					end\n					if(tim_pstrb[3]) begin\n						tdr0[31:24] <= tim_pwdata[31:24];\n					end else begin\n						tdr0[31:24] <= tdr0[31:24];\n					end\n				end else if (timer_en_negedge == 1'b1) begin \n				 	tdr0 <= 32'h0; \n				end else begin\n					if(cnt_en) begin\n						if(tdr0 == 32'hffff_ffff) begin\n							tdr0 <= 32'h0;\n						end else begin\n							tdr0 <= tdr0 + 1;\n						end\n					end else begin\n						tdr0 <= tdr0;\n					end\n				end\n\n	\n				if(tdr1_wr_sel) begin\n						if(tim_pstrb[0]) begin\n							tdr1[7:0] <= tim_pwdata[7:0];\n						end else begin\n							tdr1[7:0] <= tdr1[7:0];\n						end\n						if(tim_pstrb[1]) begin\n							tdr1[15:8] <= tim_pwdata[15:8];\n						end else begin\n							tdr1[15:8] <= tdr1[15:8];\n						end\n						if(tim_pstrb[2]) begin\n							tdr1[23:16] <= tim_pwdata[23:16];\n						end else begin\n							tdr1[23:16] <= tdr1[23:16];\n						end\n						if(tim_pstrb[3]) begin\n							tdr1[31:24] <= tim_pwdata[31:24];\n						end else begin\n							tdr1[31:24] <= tdr1[31:24];\n						end\n					end else if(timer_en_negedge == 1'b1) begin \n						tdr1 <= 32'h0;\n					end else begin\n						if(cnt_en) begin\n							if(tdr0 == 32'hffff_ffff) begin\n								if(tdr1 == 32'hffff_ffff) begin\n									tdr1 <= 32'h0;\n								end else begin\n									tdr1 <= tdr1 + 1;\n								end\n							end\n						end else begin\n							tdr1 <= tdr1;	\n						end\n					end\n\n		end\n	end\n	wire [63:0] tdr; \n	assign tdr = {tdr1, tdr0};\n\n	//TCMP\n	\n	wire tcmp0_wr_sel, tcmp1_wr_sel;\n	assign tcmp0_wr_sel = wr_en & (tim_paddr == TCMP0);\n	assign tcmp1_wr_sel = wr_en & (tim_paddr == TCMP1);\n\n	reg [31:0] tcmp0, tcmp1;\n\n	always @(posedge sys_clk or negedge sys_rst_n) begin \n		if(!sys_rst_n) begin\n			tcmp0 <= 32'hffff_ffff;\n			tcmp1 <= 32'hffff_ffff;\n		end else begin \n			if(tcmp0_wr_sel) begin\n				if(tim_pstrb[0]) begin\n				       tcmp0[7:0] <= tim_pwdata[7:0];\n			        end else begin\n				       tcmp0[7:0] <= tcmp0[7:0];\n			        end\n\n				if(tim_pstrb[1]) begin\n					tcmp0[15:8] <= tim_pwdata[15:8];\n				end else begin\n					tcmp0[15:8] <= tcmp0[15:8];\n				end \n				\n				if(tim_pstrb[2]) begin\n					tcmp0[23:16] <= tim_pwdata[23:16];\n				end else begin\n					tcmp0[23:16] <= tcmp0[23:16];\n				end \n\n				if(tim_pstrb[3]) begin\n					tcmp0[31:24] <= tim_pwdata[31:24];\n				end else begin\n					tcmp0[31:24] <= tcmp0[31:24];\n				end \n			end else begin\n				tcmp0 <= tcmp0;\n			end\n\n\n			if(tcmp1_wr_sel) begin\n				if(tim_pstrb[0]) begin\n				       tcmp1[7:0] <= tim_pwdata[7:0];\n			        end else begin\n				       tcmp1[7:0] <= tcmp1[7:0];\n			        end\n\n				if(tim_pstrb[1]) begin\n					tcmp1[15:8] <= tim_pwdata[15:8];\n				end else begin\n					tcmp1[15:8] <= tcmp1[15:8];\n				end \n				\n				if(tim_pstrb[2]) begin\n					tcmp1[23:16] <= tim_pwdata[23:16];\n				end else begin\n					tcmp1[23:16] <= tcmp1[23:16];\n				end \n\n				if(tim_pstrb[3]) begin\n					tcmp1[31:24] <= tim_pwdata[31:24];\n				end else begin\n					tcmp1[31:24] <= tcmp1[31:24];\n				end \n			end else begin \n				tcmp1 <= tcmp1;	\n			end\n		end\n	end\n\n	wire [63:0] tcmp;\n	assign tcmp = {tcmp1, tcmp0};\n\n	//TIER\n	wire tier_wr_sel, int_en_pre;\n\n	assign tier_wr_sel = wr_en & (tim_paddr == TIER);\n	assign int_en_pre = (tier_wr_sel & tim_pstrb[0]) ? tim_pwdata[0] : int_en;\n\n	always @(posedge sys_clk or sys_rst_n) begin\n		if(!sys_rst_n) begin\n			int_en <= 1'h0;\n		end else begin\n			int_en <= int_en_pre;\n		end \n	end\n	\n	wire [31:0] tier;\n	assign tier = {31'b0, int_en};\n\n\n	//TISR\n	wire int_set, int_clr, int_st_pre, tisr_wr_sel;\n	assign tisr_wr_sel = wr_en & (tim_paddr == TISR);\n	assign int_set =(tcmp == tdr);\n	assign int_clr = tisr_wr_sel & (tim_pwdata[0] == 1'b1) & tim_pstrb[0];\n	assign int_st_pre = (int_clr) ? 1'b0 : (int_set) ? 1'b1 : int_st;\n	\n	always @(posedge sys_clk or negedge sys_rst_n) begin \n		if(!sys_rst_n) begin\n			int_st <= 1'b0;\n		end else begin\n			int_st <= int_st_pre;\n		end \n	end \n\n	wire [31:0] tisr;\n	assign tisr = {31'b0, int_st};\n\n\n\n	//THCSR \n	\n	wire thcsr_wr_sel;\n\n	assign thcsr_wr_sel = wr_en & (tim_paddr == THCSR);\n\n	always @(posedge sys_clk or negedge sys_rst_n) begin\n		if(!sys_rst_n) begin\n			halt_req <= 1'b0;\n		end else begin\n			if(thcsr_wr_sel && tim_pstrb[0]) begin\n				halt_req <= tim_pwdata[0];\n			end else begin\n				halt_req <= halt_req;\n			end \n		end \n	end \n\n	wire [31:0] thcsr;\n	assign thcsr = {30'h0, halt_ack, halt_req};\n\n\n\n	//PSLVERR\n	\n	assign pslverr = tcr_wr_sel & ((timer_en & tim_pstrb[1] & (tim_pwdata[11:8] != div_val)) | \n					(timer_en & tim_pstrb[0] & (tim_pwdata[1] != div_en)) | \n					(tim_pstrb[1] & (tim_pwdata[11:8] > 4'h8)));\n\n	\n\n	//READ\n	\n	always @(*) begin\n		if(rd_en & pready) begin\n			case(tim_paddr)\n				TCR: 	rdata = tcr;\n				TDR0:	rdata = tdr0;\n				TDR1: 	rdata = tdr1;\n				TCMP0:	rdata = tcmp0;\n				TCMP1:	rdata = tcmp1;\n				TIER:	rdata = tier;\n				TISR:	rdata = tisr;\n				THCSR:	rdata = thcsr;\n				default rdata = 32'h0;\n			endcase\n		end else begin\n			rdata = 32'h0;\n		end\n	end\n\nendmodule\n","lang":"verilog"};
processSrcData(g_data);